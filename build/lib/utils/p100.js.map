{
  "version": 3,
  "sources": ["../../../src/lib/utils/p100.ts"],
  "sourcesContent": ["/* eslint-disable @typescript-eslint/ban-ts-comment */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { PlugSysinfo } from \"./types\";\nimport TpLinkCipher from \"./tpLinkCipher.js\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { AxiosResponse } from \"axios\";\nimport NewTpLinkCipher from \"./newTpLinkCipher.js\";\nimport { TpLinkAccessory } from \"./tplinkAccessory.js\";\nimport axios from \"axios\";\nimport crypto from \"crypto\";\nimport utf8 from \"utf8\";\n\nexport default class P100 implements TpLinkAccessory {\n  private _crypto = crypto;\n  protected _axios = axios;\n  private _utf8 = utf8;\n  public is_klap = true;\n\n  private encodedPassword!: string;\n  private encodedEmail!: string;\n  private privateKey!: string;\n  private publicKey!: string;\n  protected ip: string;\n  protected cookie!: string;\n  protected tplink_timeout!: number;\n  protected token!: string;\n  protected terminalUUID: string;\n  private _plugSysInfo!: PlugSysinfo;\n  private _reconnect_counter: number;\n  protected _timeout!: number;\n\n  protected tpLinkCipher!: TpLinkCipher;\n  protected newTpLinkCipher!: NewTpLinkCipher;\n\n  protected ERROR_CODES = {\n    \"0\": \"Success\",\n    \"-1010\": \"Invalid Public Key Length\",\n    \"-1012\": \"Invalid terminalUUID\",\n    \"-1501\": \"Invalid Request or Credentials\",\n    \"1002\": \"Incorrect Request\",\n    \"-1003\": \"JSON formatting error \",\n    \"9999\": \"Session Timeout\",\n    \"-1301\": \"Device Error\",\n    \"1100\": \"Handshake Failed\",\n    \"1111\": \"Login Failed\",\n    \"1112\": \"Http Transport Failed\",\n    \"1200\": \"Multiple Requests Failed\",\n    \"-1004\": \"JSON Encode Failed\",\n    \"-1005\": \"AES Decode Failed\",\n    \"-1006\": \"Request Length Error\",\n    \"-2101\": \"Account Error\",\n    \"-1\": \"ERR_COMMON_FAILED\",\n    \"1000\": \"ERR_NULL_TRANSPORT\",\n    \"1001\": \"ERR_CMD_COMMAND_CANCEL\",\n    \"-1001\": \"ERR_UNSPECIFIC\",\n    \"-1002\": \"ERR_UNKNOWN_METHOD\",\n    \"-1007\": \"ERR_CLOUD_FAILED\",\n    \"-1008\": \"ERR_PARAMS\",\n    \"-1101\": \"ERR_SESSION_PARAM\",\n    \"-1201\": \"ERR_QUICK_SETUP\",\n    \"-1302\": \"ERR_DEVICE_NEXT_EVENT\",\n    \"-1401\": \"ERR_FIRMWARE\",\n    \"-1402\": \"ERR_FIRMWARE_VER_ERROR\",\n    \"-1601\": \"ERR_TIME\",\n    \"-1602\": \"ERR_TIME_SYS\",\n    \"-1603\": \"ERR_TIME_SAVE\",\n    \"-1701\": \"ERR_WIRELESS\",\n    \"-1702\": \"ERR_WIRELESS_UNSUPPORTED\",\n    \"-1801\": \"ERR_SCHEDULE\",\n    \"-1802\": \"ERR_SCHEDULE_FULL\",\n    \"-1803\": \"ERR_SCHEDULE_CONFLICT\",\n    \"-1804\": \"ERR_SCHEDULE_SAVE\",\n    \"-1805\": \"ERR_SCHEDULE_INDEX\",\n    \"-1901\": \"ERR_COUNTDOWN\",\n    \"-1902\": \"ERR_COUNTDOWN_CONFLICT\",\n    \"-1903\": \"ERR_COUNTDOWN_SAVE\",\n    \"-2001\": \"ERR_ANTITHEFT\",\n    \"-2002\": \"ERR_ANTITHEFT_CONFLICT\",\n    \"-2003\": \"ERR_ANTITHEFT_SAVE\",\n    \"-2201\": \"ERR_STAT\",\n    \"-2202\": \"ERR_STAT_SAVE\",\n    \"-2301\": \"ERR_DST\",\n    \"-2302\": \"ERR_DST_SAVE\",\n    \"1003\": \"KLAP\",\n  };\n\n  constructor(\n    public readonly log: any,\n    public readonly ipAddress: string,\n    public readonly email: string,\n    public readonly password: string,\n    public readonly timeout: number,\n  ) {\n    this.log.debug(\"Constructing P100 on host: \" + ipAddress);\n    this.ip = ipAddress;\n    this.encryptCredentials(email, password);\n    this.createKeyPair();\n    this.terminalUUID = uuidv4();\n    this._reconnect_counter = 0;\n    this._timeout = timeout;\n  }\n\n  private encryptCredentials(email: string, password: string) {\n    //Password Encoding\n    this.encodedPassword = TpLinkCipher.mime_encoder(password);\n\n    //Email Encoding\n    this.encodedEmail = this.sha_digest_username(email);\n    this.encodedEmail = TpLinkCipher.mime_encoder(this.encodedEmail);\n  }\n\n  private sha_digest_username(data: string): string {\n    const digest = this._crypto.createHash(\"sha1\").update(data).digest(\"hex\");\n\n    return digest;\n  }\n\n  private calc_auth_hash(username: string, password: string): Buffer {\n    const usernameDigest = this._crypto\n      .createHash(\"sha1\")\n      .update(Buffer.from(username.normalize(\"NFKC\")))\n      .digest();\n    const passwordDigest = this._crypto\n      .createHash(\"sha1\")\n      .update(Buffer.from(password.normalize(\"NFKC\")))\n      .digest();\n    const digest = this._crypto\n      .createHash(\"sha256\")\n      .update(Buffer.concat([usernameDigest, passwordDigest]))\n      .digest();\n    return digest;\n  }\n\n  private createKeyPair() {\n    // Including publicKey and  privateKey from\n    // generateKeyPairSync() method with its\n    // parameters\n    const { publicKey, privateKey } = this._crypto.generateKeyPairSync(\"rsa\", {\n      publicKeyEncoding: {\n        type: \"spki\",\n        format: \"pem\",\n      },\n      privateKeyEncoding: {\n        type: \"pkcs1\",\n        format: \"pem\",\n      },\n      modulusLength: 1024,\n    });\n\n    this.privateKey = privateKey;\n    //@ts-ignore\n    this.publicKey = publicKey.toString(\"utf8\");\n  }\n\n  //old tapo requests\n  async handshake(): Promise<void> {\n    const URL = \"http://\" + this.ip + \"/app\";\n    const payload = {\n      method: \"handshake\",\n      params: {\n        key: this.publicKey,\n        requestTimeMils: Math.round(Date.now() * 1000),\n      },\n    };\n    this.log.debug(\"Old Handshake P100 on host: \" + this.ip);\n\n    const headers = {\n      Connection: \"Keep-Alive\",\n    };\n    const config = {\n      timeout: 5000,\n      headers: headers,\n    };\n\n    await this._axios\n      .post(URL, payload, config)\n      .then((res: AxiosResponse) => {\n        this.log.debug(\"Received Old Handshake P100 on host response: \" + this.ip);\n\n        if (res.data.error_code || res.status !== 200) {\n          return this.handleError(res.data!.error_code ? res.data.error_code : res.status, \"172\");\n        }\n\n        try {\n          const encryptedKey = res.data.result.key.toString(\"utf8\");\n          this.decode_handshake_key(encryptedKey);\n          if (res.headers[\"set-cookie\"]) {\n            this.cookie = res.headers[\"set-cookie\"][0].split(\";\")[0];\n          }\n          return;\n        } catch (error) {\n          return this.handleError(res.data.error_code, \"106\");\n        }\n      })\n      .catch((error: Error) => {\n        this.log.error(\"111 Error: \" + error ? error.message : \"\");\n        return error;\n      });\n  }\n\n  async login(): Promise<void> {\n    const URL = \"http://\" + this.ip + \"/app\";\n    const payload =\n      \"{\" +\n      '\"method\": \"login_device\",' +\n      '\"params\": {' +\n      '\"username\": \"' +\n      this.encodedEmail +\n      '\",' +\n      '\"password\": \"' +\n      this.encodedPassword +\n      '\"' +\n      \"},\" +\n      '\"requestTimeMils\": ' +\n      Math.round(Date.now() * 1000) +\n      \"\" +\n      \"};\";\n\n    const headers = {\n      Cookie: this.cookie,\n      Connection: \"Keep-Alive\",\n    };\n\n    this.log.debug(\"Old Login to P100 with url \" + URL);\n    this.log.debug(\"Payload \" + payload);\n    this.log.debug(\"Headers \" + JSON.stringify(headers));\n    this.log.debug(\"Cipher: \" + this.tpLinkCipher);\n    if (this.tpLinkCipher) {\n      const encryptedPayload = this.tpLinkCipher.encrypt(payload);\n\n      const securePassthroughPayload = {\n        method: \"securePassthrough\",\n        params: {\n          request: encryptedPayload,\n        },\n      };\n\n      const config = {\n        headers: headers,\n        timeout: this._timeout * 1000,\n      };\n      this.log.debug(\"Post request\");\n      await this._axios\n        .post(URL, securePassthroughPayload, config)\n        .then((res: AxiosResponse) => {\n          if (res.data.error_code || res.status !== 200) {\n            return this.handleError(res.data!.error_code ? res.data.error_code : res.status, \"226\");\n          }\n          const decryptedResponse = this.tpLinkCipher.decrypt(res.data.result.response);\n          this.log.debug(\"Decrypted Response: \" + decryptedResponse);\n          try {\n            const response = JSON.parse(decryptedResponse);\n            if (response.error_code !== 0) {\n              return this.handleError(res.data.error_code, \"152\");\n            }\n            this.token = response.result.token;\n            return;\n          } catch (error) {\n            return this.handleError(JSON.parse(decryptedResponse).error_code, \"157\");\n          }\n        })\n        .catch((error: Error) => {\n          this.log.error(\"Error Login: \" + error ? error.message : \"\");\n          return error;\n        });\n    }\n  }\n\n  private async raw_request(path: string, data: Buffer, responseType: string, params?: any): Promise<any> {\n    const URL = \"http://\" + this.ip + \"/app/\" + path;\n\n    const headers = {\n      Connection: \"Keep-Alive\",\n      Host: this.ip,\n      Accept: \"*/*\",\n      \"Content-Type\": \"application/octet-stream\",\n    };\n\n    if (this.cookie) {\n      //@ts-ignore\n      headers.Cookie = this.cookie;\n    }\n\n    const config = {\n      timeout: 5000,\n      responseType: responseType,\n      headers: headers,\n      params: params,\n    };\n    this.log.debug(\"Raw request to P100 with url \" + URL);\n    this.log.debug(\"Data: \" + data.toString(\"hex\"));\n    this.log.debug(\"Headers: \" + JSON.stringify(headers));\n    this.log.debug(\"Params: \" + JSON.stringify(params));\n    this.log.debug(\"Cipher: \" + this.tpLinkCipher);\n\n    //@ts-ignore\n    return this._axios\n      .post(URL, data, config)\n      .then((res: AxiosResponse) => {\n        this.log.debug(\"Received request on host response: \" + this.ip);\n        if (res.data.error_code || res.status !== 200) {\n          return this.handleError(res.data!.error_code ? res.data.error_code : res.status, \"273\");\n        }\n\n        try {\n          if (res.headers && res.headers[\"set-cookie\"]) {\n            this.log.debug(\"Handshake 1 cookie: \" + JSON.stringify(res.headers[\"set-cookie\"][0]));\n            this.cookie = res.headers[\"set-cookie\"][0].split(\";\")[0];\n            this.tplink_timeout = Number(res.headers[\"set-cookie\"][0].split(\";\")[1]);\n          }\n          return res.data;\n        } catch (error) {\n          return this.handleError(res.data.error_code, \"318\");\n        }\n      })\n      .catch((error: Error) => {\n        this.log.error(\"276 Error: \" + error.message);\n        if (error.message.indexOf(\"403\") > -1) {\n          this.reAuthenticate();\n        }\n        return error;\n      });\n  }\n\n  private decode_handshake_key(key: string) {\n    const buff = Buffer.from(key, \"base64\");\n\n    const decoded = this._crypto.privateDecrypt(\n      {\n        key: this.privateKey,\n        padding: this._crypto.constants.RSA_PKCS1_PADDING,\n      },\n      buff,\n    );\n\n    const b_arr = decoded.slice(0, 16);\n    const b_arr2 = decoded.slice(16, 32);\n\n    this.tpLinkCipher = new TpLinkCipher(this.log, b_arr, b_arr2);\n  }\n\n  //new tapo klap requests\n  async handshake_new(): Promise<void> {\n    this.log.debug(\"Trying new handshake\");\n\n    const local_seed = this._crypto.randomBytes(16);\n\n    await this.raw_request(\"handshake1\", local_seed, \"arraybuffer\").then((res) => {\n      if (!res || !res.subarray) {\n        this.log.debug(\"New Handshake 1 failed\");\n        return;\n      }\n      const remote_seed: Buffer = res.subarray(0, 16);\n      const server_hash: Buffer = res.subarray(16);\n\n      let auth_hash: any = undefined;\n      const ah = this.calc_auth_hash(this.email, this.password);\n      const local_seed_auth_hash = this._crypto\n        .createHash(\"sha256\")\n        .update(Buffer.concat([local_seed, remote_seed, ah]))\n        .digest();\n\n      if (local_seed_auth_hash.toString(\"hex\") === server_hash.toString(\"hex\")) {\n        this.log.debug(\"New Handshake 1 successful\");\n        auth_hash = ah;\n      }\n      const req = this._crypto\n        .createHash(\"sha256\")\n        .update(Buffer.concat([remote_seed, local_seed, auth_hash]))\n        .digest();\n\n      return this.raw_request(\"handshake2\", req, \"text\").then((res) => {\n        this.log.debug(\"New Handshake 2 successful: \" + res);\n\n        this.newTpLinkCipher = new NewTpLinkCipher(local_seed, remote_seed, auth_hash, this.log);\n        this.log.debug(\"New Init cipher successful\");\n\n        return;\n      });\n    });\n  }\n\n  async turnOff(): Promise<boolean> {\n    const payload =\n      \"{\" +\n      '\"method\": \"set_device_info\",' +\n      '\"params\": {' +\n      '\"device_on\": false' +\n      \"},\" +\n      '\"terminalUUID\": \"' +\n      this.terminalUUID +\n      '\",' +\n      '\"requestTimeMils\": ' +\n      Math.round(Date.now() * 1000) +\n      \"\" +\n      \"};\";\n    return this.sendRequest(payload);\n  }\n\n  async turnOn(): Promise<boolean> {\n    const payload =\n      \"{\" +\n      '\"method\": \"set_device_info\",' +\n      '\"params\": {' +\n      '\"device_on\": true' +\n      \"},\" +\n      '\"terminalUUID\": \"' +\n      this.terminalUUID +\n      '\",' +\n      '\"requestTimeMils\": ' +\n      Math.round(Date.now() * 1000) +\n      \"\" +\n      \"};\";\n\n    return this.sendRequest(payload);\n  }\n\n  async setPowerState(state: boolean): Promise<boolean> {\n    if (state) {\n      return this.turnOn();\n    } else {\n      return this.turnOff();\n    }\n  }\n\n  async getDeviceInfo(force?: boolean): Promise<PlugSysinfo> {\n    if (!force) {\n      return new Promise((resolve) => {\n        resolve(this.getSysInfo());\n      });\n    }\n    const URL = \"http://\" + this.ip + \"/app?token=\" + this.token;\n\n    const payload = \"{\" + '\"method\": \"get_device_info\",' + '\"requestTimeMils\": ' + Math.round(Date.now() * 1000) + \"\" + \"};\";\n    const headers = {\n      Cookie: this.cookie,\n    };\n\n    if (this.tpLinkCipher) {\n      const encryptedPayload = this.tpLinkCipher.encrypt(payload);\n\n      const securePassthroughPayload = {\n        method: \"securePassthrough\",\n        params: {\n          request: encryptedPayload,\n        },\n      };\n\n      const config = {\n        headers: headers,\n        timeout: this._timeout * 1000,\n      };\n      //@ts-ignore\n      return this._axios\n        .post(URL, securePassthroughPayload, config)\n        .then((res: any) => {\n          if (res.data.error_code) {\n            if ((res.data.error_code === \"9999\" || res.data.error_code === 9999) && this._reconnect_counter <= 3) {\n              //@ts-ignore\n              this.log.error(\" Error Code: \" + res.data.error_code + \", \" + this.ERROR_CODES[res.data.error_code]);\n              this.log.debug(\"Trying to reconnect...\");\n              return this.reconnect().then(() => {\n                return this.getDeviceInfo();\n              });\n            }\n            this._reconnect_counter = 0;\n            return this.handleError(res.data.error_code, \"326\");\n          }\n\n          const decryptedResponse = this.tpLinkCipher.decrypt(res.data.result.response);\n          try {\n            const response = JSON.parse(decryptedResponse);\n            if (response.error_code !== 0) {\n              return this.handleError(response.error_code, \"333\");\n            }\n            this.setSysInfo(response.result);\n            this.log.debug(\"Device Info: \", response.result);\n\n            return this.getSysInfo();\n          } catch (error) {\n            this.log.debug(error.stack);\n            return this.handleError(JSON.parse(decryptedResponse).error_code, \"340\");\n          }\n        })\n        .catch((error: Error) => {\n          this.log.error(\"371 Error: \" + error ? error.message : \"\");\n          return error;\n        });\n    } else if (this.newTpLinkCipher) {\n      const data = this.newTpLinkCipher.encrypt(payload);\n\n      const URL = \"http://\" + this.ip + \"/app/\" + \"request\";\n      const headers = {\n        Connection: \"Keep-Alive\",\n        Host: this.ip,\n        Accept: \"*/*\",\n        \"Content-Type\": \"application/octet-stream\",\n      };\n\n      if (this.cookie) {\n        //@ts-ignore\n        headers.Cookie = this.cookie;\n      }\n\n      const config = {\n        timeout: 5000,\n        responseType: \"arraybuffer\",\n        headers: headers,\n        params: { seq: data.seq.toString() },\n      };\n      //@ts-ignore\n      return this._axios\n        .post(URL, data.encryptedPayload, config)\n        .then((res: AxiosResponse) => {\n          if (res.data.error_code) {\n            return this.handleError(res.data.error_code, \"309\");\n          }\n\n          try {\n            if (res.headers && res.headers[\"set-cookie\"]) {\n              this.cookie = res.headers[\"set-cookie\"][0].split(\";\")[0];\n            }\n\n            const response = JSON.parse(this.newTpLinkCipher.decrypt(res.data));\n\n            if (response.error_code !== 0) {\n              return this.handleError(response.error_code, \"333\");\n            }\n            this.setSysInfo(response.result);\n            this.log.debug(\"Device Info: \", response.result);\n\n            return this.getSysInfo();\n          } catch (error) {\n            this.log.debug(this.newTpLinkCipher.decrypt(res.data));\n            this.log.debug(\"Status: \" + res.status);\n            return this.handleError(res.data.error_code, \"480\");\n          }\n        })\n        .catch((error: Error) => {\n          this.log.debug(\"469 Error: \" + JSON.stringify(error));\n          this.log.info(\"469 Error: \" + error.message);\n          if (error.message.indexOf(\"403\") > -1) {\n            this.reAuthenticate();\n          }\n          return error;\n        });\n    } else {\n      return new Promise<PlugSysinfo>((resolve, reject) => {\n        reject();\n      });\n    }\n  }\n\n  /**\n   * Cached value of `sysinfo.device_id`  if set.\n   */\n  get id(): string {\n    if (this.getSysInfo()) {\n      return this.getSysInfo().device_id;\n    }\n    return \"\";\n  }\n\n  /**\n   * Cached value of `sysinfo.device_id`  if set.\n   */\n  get name(): string {\n    if (this.getSysInfo()) {\n      return Buffer.from(this.getSysInfo().nickname, \"base64\").toString(\"utf8\");\n    }\n    return \"\";\n  }\n\n  get model(): string {\n    if (this.getSysInfo()) {\n      return this.getSysInfo().model;\n    }\n    return \"\";\n  }\n\n  get serialNumber(): string {\n    if (this.getSysInfo()) {\n      return this.getSysInfo().hw_id;\n    }\n    return \"\";\n  }\n\n  get firmwareRevision(): string {\n    if (this.getSysInfo()) {\n      return this.getSysInfo().fw_ver;\n    }\n    return \"\";\n  }\n\n  get hardwareRevision(): string {\n    if (this.getSysInfo()) {\n      return this.getSysInfo().hw_ver;\n    }\n    return \"\";\n  }\n\n  protected setSysInfo(sysInfo: PlugSysinfo) {\n    this._plugSysInfo = sysInfo;\n    this._plugSysInfo.last_update = Date.now();\n  }\n\n  public getSysInfo(): PlugSysinfo {\n    return this._plugSysInfo;\n  }\n\n  protected handleError(errorCode: number | string, line: string): boolean {\n    //@ts-ignore\n    const errorMessage = this.ERROR_CODES[errorCode];\n    if (typeof errorCode === \"number\" && errorCode === 1003) {\n      this.log.info(\"Trying KLAP Auth\");\n      this.is_klap = true;\n    } else {\n      this.log.error(line + \" Error Code: \" + errorCode + \", \" + errorMessage + \" \" + this.ip);\n    }\n    return false;\n  }\n\n  protected async sendRequest(payload: string): Promise<boolean> {\n    if (this.tpLinkCipher) {\n      return this.handleRequest(payload)\n        .then((result) => {\n          return result ? true : false;\n        })\n        .catch((error) => {\n          if (error.message && error.message.indexOf(\"9999\") > 0 && this._reconnect_counter <= 3) {\n            return this.reconnect().then(() => {\n              return this.handleRequest(payload).then((result) => {\n                return result ? true : false;\n              });\n            });\n          }\n          this._reconnect_counter = 0;\n          return false;\n        });\n    } else {\n      return this.handleKlapRequest(payload)\n        .then((result) => {\n          return result ? true : false;\n        })\n        .catch((error) => {\n          if (error.message && error.message.indexOf(\"9999\") > 0 && this._reconnect_counter <= 3) {\n            return this.newReconnect().then(() => {\n              return this.handleKlapRequest(payload).then((result) => {\n                return result ? true : false;\n              });\n            });\n          }\n          this._reconnect_counter = 0;\n          return false;\n        });\n    }\n  }\n\n  protected handleRequest(payload: string): Promise<any> {\n    const URL = \"http://\" + this.ip + \"/app?token=\" + this.token;\n\n    const headers = {\n      Cookie: this.cookie,\n      Connection: \"Keep-Alive\",\n    };\n\n    if (this.tpLinkCipher) {\n      const encryptedPayload = this.tpLinkCipher.encrypt(payload);\n\n      const securePassthroughPayload = {\n        method: \"securePassthrough\",\n        params: {\n          request: encryptedPayload,\n        },\n      };\n\n      const config = {\n        headers: headers,\n        timeout: this._timeout * 1000,\n      };\n\n      return this._axios\n        .post(URL, securePassthroughPayload, config)\n        .then((res: AxiosResponse) => {\n          if (res.data.error_code) {\n            if (res.data.error_code === \"9999\" || (res.data.error_code === 9999 && this._reconnect_counter <= 3)) {\n              //@ts-ignore\n              this.log.error(\" Error Code: \" + res.data.error_code + \", \" + this.ERROR_CODES[res.data.error_code]);\n              this.log.debug(\"Trying to reconnect...\");\n              return this.reconnect().then(() => {\n                return this.getDeviceInfo();\n              });\n            }\n            this._reconnect_counter = 0;\n            return this.handleError(res.data.error_code, \"357\");\n          }\n\n          const decryptedResponse = this.tpLinkCipher.decrypt(res.data.result.response);\n          try {\n            const response = JSON.parse(decryptedResponse);\n            this.log.debug(response);\n            if (response.error_code !== 0) {\n              return this.handleError(response.error_code, \"364\");\n            }\n            return response;\n          } catch (error) {\n            return this.handleError(JSON.parse(decryptedResponse).error_code, \"368\");\n          }\n        })\n        .catch((error: Error) => {\n          return this.handleError(error.message, \"656\");\n        });\n    }\n    return new Promise<true>((resolve, reject) => {\n      reject();\n    });\n  }\n\n  protected handleKlapRequest(payload: string): Promise<any> {\n    if (this.newTpLinkCipher) {\n      const data = this.newTpLinkCipher.encrypt(payload);\n\n      return this.raw_request(\"request\", data.encryptedPayload, \"arraybuffer\", { seq: data.seq.toString() })\n        .then((res) => {\n          return JSON.parse(this.newTpLinkCipher.decrypt(res));\n        })\n        .catch((error: Error) => {\n          return this.handleError(error.message, \"671\");\n        });\n    }\n    return new Promise<true>((resolve, reject) => {\n      reject();\n    });\n  }\n\n  protected async reconnect(): Promise<void> {\n    this._reconnect_counter++;\n    return this.handshake().then(() => {\n      this.login().then(() => {\n        return;\n      });\n    });\n  }\n\n  protected async newReconnect(): Promise<void> {\n    this._reconnect_counter++;\n    return this.handshake_new().then(() => {\n      return;\n    });\n  }\n\n  private reAuthenticate(): void {\n    if (this.is_klap) {\n      this.handshake_new()\n        .then(() => {\n          this.log.info(\"KLAP Authenticated successfully\");\n        })\n        .catch(() => {\n          this.log.error(\"KLAP Handshake New failed\");\n          this.is_klap = false;\n        });\n    } else {\n      this.handshake().then(() => {\n        this.login()\n          .then(() => {\n            this.log.info(\"Authenticated successfully\");\n          })\n          .catch(() => {\n            this.log.error(\"Login failed\");\n          });\n      });\n    }\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA,0BAAyB;AACzB,kBAA6B;AAE7B,6BAA4B;AAE5B,IAAAA,gBAAkB;AAClB,oBAAmB;AACnB,kBAAiB;AAEjB,MAAO,KAA8C;AAAA,EA0EnD,YACkB,KACA,WACA,OACA,UACA,SAChB;AALgB;AACA;AACA;AACA;AACA;AA9ElB,SAAQ,UAAU,cAAAC;AAClB,SAAU,SAAS,cAAAC;AACnB,SAAQ,QAAQ,YAAAC;AAChB,SAAO,UAAU;AAkBjB,SAAU,cAAc;AAAA,MACtB,KAAK;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,SAAS;AAAA,MACT,QAAQ;AAAA,IACV;AASE,SAAK,IAAI,MAAM,gCAAgC,SAAS;AACxD,SAAK,KAAK;AACV,SAAK,mBAAmB,OAAO,QAAQ;AACvC,SAAK,cAAc;AACnB,SAAK,mBAAe,YAAAC,IAAO;AAC3B,SAAK,qBAAqB;AAC1B,SAAK,WAAW;AAAA,EAClB;AAAA,EAEQ,mBAAmB,OAAe,UAAkB;AAE1D,SAAK,kBAAkB,oBAAAC,QAAa,aAAa,QAAQ;AAGzD,SAAK,eAAe,KAAK,oBAAoB,KAAK;AAClD,SAAK,eAAe,oBAAAA,QAAa,aAAa,KAAK,YAAY;AAAA,EACjE;AAAA,EAEQ,oBAAoB,MAAsB;AAChD,UAAM,SAAS,KAAK,QAAQ,WAAW,MAAM,EAAE,OAAO,IAAI,EAAE,OAAO,KAAK;AAExE,WAAO;AAAA,EACT;AAAA,EAEQ,eAAe,UAAkB,UAA0B;AACjE,UAAM,iBAAiB,KAAK,QACzB,WAAW,MAAM,EACjB,OAAO,OAAO,KAAK,SAAS,UAAU,MAAM,CAAC,CAAC,EAC9C,OAAO;AACV,UAAM,iBAAiB,KAAK,QACzB,WAAW,MAAM,EACjB,OAAO,OAAO,KAAK,SAAS,UAAU,MAAM,CAAC,CAAC,EAC9C,OAAO;AACV,UAAM,SAAS,KAAK,QACjB,WAAW,QAAQ,EACnB,OAAO,OAAO,OAAO,CAAC,gBAAgB,cAAc,CAAC,CAAC,EACtD,OAAO;AACV,WAAO;AAAA,EACT;AAAA,EAEQ,gBAAgB;AAItB,UAAM,EAAE,WAAW,WAAW,IAAI,KAAK,QAAQ,oBAAoB,OAAO;AAAA,MACxE,mBAAmB;AAAA,QACjB,MAAM;AAAA,QACN,QAAQ;AAAA,MACV;AAAA,MACA,oBAAoB;AAAA,QAClB,MAAM;AAAA,QACN,QAAQ;AAAA,MACV;AAAA,MACA,eAAe;AAAA,IACjB,CAAC;AAED,SAAK,aAAa;AAElB,SAAK,YAAY,UAAU,SAAS,MAAM;AAAA,EAC5C;AAAA,EAGA,MAAM,YAA2B;AAC/B,UAAM,MAAM,YAAY,KAAK,KAAK;AAClC,UAAM,UAAU;AAAA,MACd,QAAQ;AAAA,MACR,QAAQ;AAAA,QACN,KAAK,KAAK;AAAA,QACV,iBAAiB,KAAK,MAAM,KAAK,IAAI,IAAI,GAAI;AAAA,MAC/C;AAAA,IACF;AACA,SAAK,IAAI,MAAM,iCAAiC,KAAK,EAAE;AAEvD,UAAM,UAAU;AAAA,MACd,YAAY;AAAA,IACd;AACA,UAAM,SAAS;AAAA,MACb,SAAS;AAAA,MACT;AAAA,IACF;AAEA,UAAM,KAAK,OACR,KAAK,KAAK,SAAS,MAAM,EACzB,KAAK,CAAC,QAAuB;AAC5B,WAAK,IAAI,MAAM,mDAAmD,KAAK,EAAE;AAEzE,UAAI,IAAI,KAAK,cAAc,IAAI,WAAW,KAAK;AAC7C,eAAO,KAAK,YAAY,IAAI,KAAM,aAAa,IAAI,KAAK,aAAa,IAAI,QAAQ,KAAK;AAAA,MACxF;AAEA,UAAI;AACF,cAAM,eAAe,IAAI,KAAK,OAAO,IAAI,SAAS,MAAM;AACxD,aAAK,qBAAqB,YAAY;AACtC,YAAI,IAAI,QAAQ,eAAe;AAC7B,eAAK,SAAS,IAAI,QAAQ,cAAc,GAAG,MAAM,GAAG,EAAE;AAAA,QACxD;AACA;AAAA,MACF,SAAS,OAAP;AACA,eAAO,KAAK,YAAY,IAAI,KAAK,YAAY,KAAK;AAAA,MACpD;AAAA,IACF,CAAC,EACA,MAAM,CAAC,UAAiB;AACvB,WAAK,IAAI,MAAM,gBAAgB,QAAQ,MAAM,UAAU,EAAE;AACzD,aAAO;AAAA,IACT,CAAC;AAAA,EACL;AAAA,EAEA,MAAM,QAAuB;AAC3B,UAAM,MAAM,YAAY,KAAK,KAAK;AAClC,UAAM,UACJ,uDAIA,KAAK,eACL,oBAEA,KAAK,kBACL,2BAGA,KAAK,MAAM,KAAK,IAAI,IAAI,GAAI,IAE5B;AAEF,UAAM,UAAU;AAAA,MACd,QAAQ,KAAK;AAAA,MACb,YAAY;AAAA,IACd;AAEA,SAAK,IAAI,MAAM,gCAAgC,GAAG;AAClD,SAAK,IAAI,MAAM,aAAa,OAAO;AACnC,SAAK,IAAI,MAAM,aAAa,KAAK,UAAU,OAAO,CAAC;AACnD,SAAK,IAAI,MAAM,aAAa,KAAK,YAAY;AAC7C,QAAI,KAAK,cAAc;AACrB,YAAM,mBAAmB,KAAK,aAAa,QAAQ,OAAO;AAE1D,YAAM,2BAA2B;AAAA,QAC/B,QAAQ;AAAA,QACR,QAAQ;AAAA,UACN,SAAS;AAAA,QACX;AAAA,MACF;AAEA,YAAM,SAAS;AAAA,QACb;AAAA,QACA,SAAS,KAAK,WAAW;AAAA,MAC3B;AACA,WAAK,IAAI,MAAM,cAAc;AAC7B,YAAM,KAAK,OACR,KAAK,KAAK,0BAA0B,MAAM,EAC1C,KAAK,CAAC,QAAuB;AAC5B,YAAI,IAAI,KAAK,cAAc,IAAI,WAAW,KAAK;AAC7C,iBAAO,KAAK,YAAY,IAAI,KAAM,aAAa,IAAI,KAAK,aAAa,IAAI,QAAQ,KAAK;AAAA,QACxF;AACA,cAAM,oBAAoB,KAAK,aAAa,QAAQ,IAAI,KAAK,OAAO,QAAQ;AAC5E,aAAK,IAAI,MAAM,yBAAyB,iBAAiB;AACzD,YAAI;AACF,gBAAM,WAAW,KAAK,MAAM,iBAAiB;AAC7C,cAAI,SAAS,eAAe,GAAG;AAC7B,mBAAO,KAAK,YAAY,IAAI,KAAK,YAAY,KAAK;AAAA,UACpD;AACA,eAAK,QAAQ,SAAS,OAAO;AAC7B;AAAA,QACF,SAAS,OAAP;AACA,iBAAO,KAAK,YAAY,KAAK,MAAM,iBAAiB,EAAE,YAAY,KAAK;AAAA,QACzE;AAAA,MACF,CAAC,EACA,MAAM,CAAC,UAAiB;AACvB,aAAK,IAAI,MAAM,kBAAkB,QAAQ,MAAM,UAAU,EAAE;AAC3D,eAAO;AAAA,MACT,CAAC;AAAA,IACL;AAAA,EACF;AAAA,EAEA,MAAc,YAAY,MAAc,MAAc,cAAsB,QAA4B;AACtG,UAAM,MAAM,YAAY,KAAK,KAAK,UAAU;AAE5C,UAAM,UAAU;AAAA,MACd,YAAY;AAAA,MACZ,MAAM,KAAK;AAAA,MACX,QAAQ;AAAA,MACR,gBAAgB;AAAA,IAClB;AAEA,QAAI,KAAK,QAAQ;AAEf,cAAQ,SAAS,KAAK;AAAA,IACxB;AAEA,UAAM,SAAS;AAAA,MACb,SAAS;AAAA,MACT;AAAA,MACA;AAAA,MACA;AAAA,IACF;AACA,SAAK,IAAI,MAAM,kCAAkC,GAAG;AACpD,SAAK,IAAI,MAAM,WAAW,KAAK,SAAS,KAAK,CAAC;AAC9C,SAAK,IAAI,MAAM,cAAc,KAAK,UAAU,OAAO,CAAC;AACpD,SAAK,IAAI,MAAM,aAAa,KAAK,UAAU,MAAM,CAAC;AAClD,SAAK,IAAI,MAAM,aAAa,KAAK,YAAY;AAG7C,WAAO,KAAK,OACT,KAAK,KAAK,MAAM,MAAM,EACtB,KAAK,CAAC,QAAuB;AAC5B,WAAK,IAAI,MAAM,wCAAwC,KAAK,EAAE;AAC9D,UAAI,IAAI,KAAK,cAAc,IAAI,WAAW,KAAK;AAC7C,eAAO,KAAK,YAAY,IAAI,KAAM,aAAa,IAAI,KAAK,aAAa,IAAI,QAAQ,KAAK;AAAA,MACxF;AAEA,UAAI;AACF,YAAI,IAAI,WAAW,IAAI,QAAQ,eAAe;AAC5C,eAAK,IAAI,MAAM,yBAAyB,KAAK,UAAU,IAAI,QAAQ,cAAc,EAAE,CAAC;AACpF,eAAK,SAAS,IAAI,QAAQ,cAAc,GAAG,MAAM,GAAG,EAAE;AACtD,eAAK,iBAAiB,OAAO,IAAI,QAAQ,cAAc,GAAG,MAAM,GAAG,EAAE,EAAE;AAAA,QACzE;AACA,eAAO,IAAI;AAAA,MACb,SAAS,OAAP;AACA,eAAO,KAAK,YAAY,IAAI,KAAK,YAAY,KAAK;AAAA,MACpD;AAAA,IACF,CAAC,EACA,MAAM,CAAC,UAAiB;AACvB,WAAK,IAAI,MAAM,gBAAgB,MAAM,OAAO;AAC5C,UAAI,MAAM,QAAQ,QAAQ,KAAK,IAAI,IAAI;AACrC,aAAK,eAAe;AAAA,MACtB;AACA,aAAO;AAAA,IACT,CAAC;AAAA,EACL;AAAA,EAEQ,qBAAqB,KAAa;AACxC,UAAM,OAAO,OAAO,KAAK,KAAK,QAAQ;AAEtC,UAAM,UAAU,KAAK,QAAQ;AAAA,MAC3B;AAAA,QACE,KAAK,KAAK;AAAA,QACV,SAAS,KAAK,QAAQ,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,IACF;AAEA,UAAM,QAAQ,QAAQ,MAAM,GAAG,EAAE;AACjC,UAAM,SAAS,QAAQ,MAAM,IAAI,EAAE;AAEnC,SAAK,eAAe,IAAI,oBAAAA,QAAa,KAAK,KAAK,OAAO,MAAM;AAAA,EAC9D;AAAA,EAGA,MAAM,gBAA+B;AACnC,SAAK,IAAI,MAAM,sBAAsB;AAErC,UAAM,aAAa,KAAK,QAAQ,YAAY,EAAE;AAE9C,UAAM,KAAK,YAAY,cAAc,YAAY,aAAa,EAAE,KAAK,CAAC,QAAQ;AAC5E,UAAI,CAAC,OAAO,CAAC,IAAI,UAAU;AACzB,aAAK,IAAI,MAAM,wBAAwB;AACvC;AAAA,MACF;AACA,YAAM,cAAsB,IAAI,SAAS,GAAG,EAAE;AAC9C,YAAM,cAAsB,IAAI,SAAS,EAAE;AAE3C,UAAI,YAAiB;AACrB,YAAM,KAAK,KAAK,eAAe,KAAK,OAAO,KAAK,QAAQ;AACxD,YAAM,uBAAuB,KAAK,QAC/B,WAAW,QAAQ,EACnB,OAAO,OAAO,OAAO,CAAC,YAAY,aAAa,EAAE,CAAC,CAAC,EACnD,OAAO;AAEV,UAAI,qBAAqB,SAAS,KAAK,MAAM,YAAY,SAAS,KAAK,GAAG;AACxE,aAAK,IAAI,MAAM,4BAA4B;AAC3C,oBAAY;AAAA,MACd;AACA,YAAM,MAAM,KAAK,QACd,WAAW,QAAQ,EACnB,OAAO,OAAO,OAAO,CAAC,aAAa,YAAY,SAAS,CAAC,CAAC,EAC1D,OAAO;AAEV,aAAO,KAAK,YAAY,cAAc,KAAK,MAAM,EAAE,KAAK,CAACC,SAAQ;AAC/D,aAAK,IAAI,MAAM,iCAAiCA,IAAG;AAEnD,aAAK,kBAAkB,IAAI,uBAAAC,QAAgB,YAAY,aAAa,WAAW,KAAK,GAAG;AACvF,aAAK,IAAI,MAAM,4BAA4B;AAE3C;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,UAA4B;AAChC,UAAM,UACJ,kFAMA,KAAK,eACL,0BAEA,KAAK,MAAM,KAAK,IAAI,IAAI,GAAI,IAE5B;AACF,WAAO,KAAK,YAAY,OAAO;AAAA,EACjC;AAAA,EAEA,MAAM,SAA2B;AAC/B,UAAM,UACJ,iFAMA,KAAK,eACL,0BAEA,KAAK,MAAM,KAAK,IAAI,IAAI,GAAI,IAE5B;AAEF,WAAO,KAAK,YAAY,OAAO;AAAA,EACjC;AAAA,EAEA,MAAM,cAAc,OAAkC;AACpD,QAAI,OAAO;AACT,aAAO,KAAK,OAAO;AAAA,IACrB,OAAO;AACL,aAAO,KAAK,QAAQ;AAAA,IACtB;AAAA,EACF;AAAA,EAEA,MAAM,cAAc,OAAuC;AACzD,QAAI,CAAC,OAAO;AACV,aAAO,IAAI,QAAQ,CAAC,YAAY;AAC9B,gBAAQ,KAAK,WAAW,CAAC;AAAA,MAC3B,CAAC;AAAA,IACH;AACA,UAAM,MAAM,YAAY,KAAK,KAAK,gBAAgB,KAAK;AAEvD,UAAM,UAAU,qDAA+D,KAAK,MAAM,KAAK,IAAI,IAAI,GAAI,IAAS;AACpH,UAAM,UAAU;AAAA,MACd,QAAQ,KAAK;AAAA,IACf;AAEA,QAAI,KAAK,cAAc;AACrB,YAAM,mBAAmB,KAAK,aAAa,QAAQ,OAAO;AAE1D,YAAM,2BAA2B;AAAA,QAC/B,QAAQ;AAAA,QACR,QAAQ;AAAA,UACN,SAAS;AAAA,QACX;AAAA,MACF;AAEA,YAAM,SAAS;AAAA,QACb;AAAA,QACA,SAAS,KAAK,WAAW;AAAA,MAC3B;AAEA,aAAO,KAAK,OACT,KAAK,KAAK,0BAA0B,MAAM,EAC1C,KAAK,CAAC,QAAa;AAClB,YAAI,IAAI,KAAK,YAAY;AACvB,eAAK,IAAI,KAAK,eAAe,UAAU,IAAI,KAAK,eAAe,SAAS,KAAK,sBAAsB,GAAG;AAEpG,iBAAK,IAAI,MAAM,kBAAkB,IAAI,KAAK,aAAa,OAAO,KAAK,YAAY,IAAI,KAAK,WAAW;AACnG,iBAAK,IAAI,MAAM,wBAAwB;AACvC,mBAAO,KAAK,UAAU,EAAE,KAAK,MAAM;AACjC,qBAAO,KAAK,cAAc;AAAA,YAC5B,CAAC;AAAA,UACH;AACA,eAAK,qBAAqB;AAC1B,iBAAO,KAAK,YAAY,IAAI,KAAK,YAAY,KAAK;AAAA,QACpD;AAEA,cAAM,oBAAoB,KAAK,aAAa,QAAQ,IAAI,KAAK,OAAO,QAAQ;AAC5E,YAAI;AACF,gBAAM,WAAW,KAAK,MAAM,iBAAiB;AAC7C,cAAI,SAAS,eAAe,GAAG;AAC7B,mBAAO,KAAK,YAAY,SAAS,YAAY,KAAK;AAAA,UACpD;AACA,eAAK,WAAW,SAAS,MAAM;AAC/B,eAAK,IAAI,MAAM,iBAAiB,SAAS,MAAM;AAE/C,iBAAO,KAAK,WAAW;AAAA,QACzB,SAAS,OAAP;AACA,eAAK,IAAI,MAAM,MAAM,KAAK;AAC1B,iBAAO,KAAK,YAAY,KAAK,MAAM,iBAAiB,EAAE,YAAY,KAAK;AAAA,QACzE;AAAA,MACF,CAAC,EACA,MAAM,CAAC,UAAiB;AACvB,aAAK,IAAI,MAAM,gBAAgB,QAAQ,MAAM,UAAU,EAAE;AACzD,eAAO;AAAA,MACT,CAAC;AAAA,IACL,WAAW,KAAK,iBAAiB;AAC/B,YAAM,OAAO,KAAK,gBAAgB,QAAQ,OAAO;AAEjD,YAAMC,OAAM,YAAY,KAAK,KAAK;AAClC,YAAMC,WAAU;AAAA,QACd,YAAY;AAAA,QACZ,MAAM,KAAK;AAAA,QACX,QAAQ;AAAA,QACR,gBAAgB;AAAA,MAClB;AAEA,UAAI,KAAK,QAAQ;AAEf,QAAAA,SAAQ,SAAS,KAAK;AAAA,MACxB;AAEA,YAAM,SAAS;AAAA,QACb,SAAS;AAAA,QACT,cAAc;AAAA,QACd,SAASA;AAAA,QACT,QAAQ,EAAE,KAAK,KAAK,IAAI,SAAS,EAAE;AAAA,MACrC;AAEA,aAAO,KAAK,OACT,KAAKD,MAAK,KAAK,kBAAkB,MAAM,EACvC,KAAK,CAAC,QAAuB;AAC5B,YAAI,IAAI,KAAK,YAAY;AACvB,iBAAO,KAAK,YAAY,IAAI,KAAK,YAAY,KAAK;AAAA,QACpD;AAEA,YAAI;AACF,cAAI,IAAI,WAAW,IAAI,QAAQ,eAAe;AAC5C,iBAAK,SAAS,IAAI,QAAQ,cAAc,GAAG,MAAM,GAAG,EAAE;AAAA,UACxD;AAEA,gBAAM,WAAW,KAAK,MAAM,KAAK,gBAAgB,QAAQ,IAAI,IAAI,CAAC;AAElE,cAAI,SAAS,eAAe,GAAG;AAC7B,mBAAO,KAAK,YAAY,SAAS,YAAY,KAAK;AAAA,UACpD;AACA,eAAK,WAAW,SAAS,MAAM;AAC/B,eAAK,IAAI,MAAM,iBAAiB,SAAS,MAAM;AAE/C,iBAAO,KAAK,WAAW;AAAA,QACzB,SAAS,OAAP;AACA,eAAK,IAAI,MAAM,KAAK,gBAAgB,QAAQ,IAAI,IAAI,CAAC;AACrD,eAAK,IAAI,MAAM,aAAa,IAAI,MAAM;AACtC,iBAAO,KAAK,YAAY,IAAI,KAAK,YAAY,KAAK;AAAA,QACpD;AAAA,MACF,CAAC,EACA,MAAM,CAAC,UAAiB;AACvB,aAAK,IAAI,MAAM,gBAAgB,KAAK,UAAU,KAAK,CAAC;AACpD,aAAK,IAAI,KAAK,gBAAgB,MAAM,OAAO;AAC3C,YAAI,MAAM,QAAQ,QAAQ,KAAK,IAAI,IAAI;AACrC,eAAK,eAAe;AAAA,QACtB;AACA,eAAO;AAAA,MACT,CAAC;AAAA,IACL,OAAO;AACL,aAAO,IAAI,QAAqB,CAAC,SAAS,WAAW;AACnD,eAAO;AAAA,MACT,CAAC;AAAA,IACH;AAAA,EACF;AAAA,EAKA,IAAI,KAAa;AACf,QAAI,KAAK,WAAW,GAAG;AACrB,aAAO,KAAK,WAAW,EAAE;AAAA,IAC3B;AACA,WAAO;AAAA,EACT;AAAA,EAKA,IAAI,OAAe;AACjB,QAAI,KAAK,WAAW,GAAG;AACrB,aAAO,OAAO,KAAK,KAAK,WAAW,EAAE,UAAU,QAAQ,EAAE,SAAS,MAAM;AAAA,IAC1E;AACA,WAAO;AAAA,EACT;AAAA,EAEA,IAAI,QAAgB;AAClB,QAAI,KAAK,WAAW,GAAG;AACrB,aAAO,KAAK,WAAW,EAAE;AAAA,IAC3B;AACA,WAAO;AAAA,EACT;AAAA,EAEA,IAAI,eAAuB;AACzB,QAAI,KAAK,WAAW,GAAG;AACrB,aAAO,KAAK,WAAW,EAAE;AAAA,IAC3B;AACA,WAAO;AAAA,EACT;AAAA,EAEA,IAAI,mBAA2B;AAC7B,QAAI,KAAK,WAAW,GAAG;AACrB,aAAO,KAAK,WAAW,EAAE;AAAA,IAC3B;AACA,WAAO;AAAA,EACT;AAAA,EAEA,IAAI,mBAA2B;AAC7B,QAAI,KAAK,WAAW,GAAG;AACrB,aAAO,KAAK,WAAW,EAAE;AAAA,IAC3B;AACA,WAAO;AAAA,EACT;AAAA,EAEU,WAAW,SAAsB;AACzC,SAAK,eAAe;AACpB,SAAK,aAAa,cAAc,KAAK,IAAI;AAAA,EAC3C;AAAA,EAEO,aAA0B;AAC/B,WAAO,KAAK;AAAA,EACd;AAAA,EAEU,YAAY,WAA4B,MAAuB;AAEvE,UAAM,eAAe,KAAK,YAAY;AACtC,QAAI,OAAO,cAAc,YAAY,cAAc,MAAM;AACvD,WAAK,IAAI,KAAK,kBAAkB;AAChC,WAAK,UAAU;AAAA,IACjB,OAAO;AACL,WAAK,IAAI,MAAM,OAAO,kBAAkB,YAAY,OAAO,eAAe,MAAM,KAAK,EAAE;AAAA,IACzF;AACA,WAAO;AAAA,EACT;AAAA,EAEA,MAAgB,YAAY,SAAmC;AAC7D,QAAI,KAAK,cAAc;AACrB,aAAO,KAAK,cAAc,OAAO,EAC9B,KAAK,CAAC,WAAW;AAChB,eAAO,SAAS,OAAO;AAAA,MACzB,CAAC,EACA,MAAM,CAAC,UAAU;AAChB,YAAI,MAAM,WAAW,MAAM,QAAQ,QAAQ,MAAM,IAAI,KAAK,KAAK,sBAAsB,GAAG;AACtF,iBAAO,KAAK,UAAU,EAAE,KAAK,MAAM;AACjC,mBAAO,KAAK,cAAc,OAAO,EAAE,KAAK,CAAC,WAAW;AAClD,qBAAO,SAAS,OAAO;AAAA,YACzB,CAAC;AAAA,UACH,CAAC;AAAA,QACH;AACA,aAAK,qBAAqB;AAC1B,eAAO;AAAA,MACT,CAAC;AAAA,IACL,OAAO;AACL,aAAO,KAAK,kBAAkB,OAAO,EAClC,KAAK,CAAC,WAAW;AAChB,eAAO,SAAS,OAAO;AAAA,MACzB,CAAC,EACA,MAAM,CAAC,UAAU;AAChB,YAAI,MAAM,WAAW,MAAM,QAAQ,QAAQ,MAAM,IAAI,KAAK,KAAK,sBAAsB,GAAG;AACtF,iBAAO,KAAK,aAAa,EAAE,KAAK,MAAM;AACpC,mBAAO,KAAK,kBAAkB,OAAO,EAAE,KAAK,CAAC,WAAW;AACtD,qBAAO,SAAS,OAAO;AAAA,YACzB,CAAC;AAAA,UACH,CAAC;AAAA,QACH;AACA,aAAK,qBAAqB;AAC1B,eAAO;AAAA,MACT,CAAC;AAAA,IACL;AAAA,EACF;AAAA,EAEU,cAAc,SAA+B;AACrD,UAAM,MAAM,YAAY,KAAK,KAAK,gBAAgB,KAAK;AAEvD,UAAM,UAAU;AAAA,MACd,QAAQ,KAAK;AAAA,MACb,YAAY;AAAA,IACd;AAEA,QAAI,KAAK,cAAc;AACrB,YAAM,mBAAmB,KAAK,aAAa,QAAQ,OAAO;AAE1D,YAAM,2BAA2B;AAAA,QAC/B,QAAQ;AAAA,QACR,QAAQ;AAAA,UACN,SAAS;AAAA,QACX;AAAA,MACF;AAEA,YAAM,SAAS;AAAA,QACb;AAAA,QACA,SAAS,KAAK,WAAW;AAAA,MAC3B;AAEA,aAAO,KAAK,OACT,KAAK,KAAK,0BAA0B,MAAM,EAC1C,KAAK,CAAC,QAAuB;AAC5B,YAAI,IAAI,KAAK,YAAY;AACvB,cAAI,IAAI,KAAK,eAAe,UAAW,IAAI,KAAK,eAAe,QAAQ,KAAK,sBAAsB,GAAI;AAEpG,iBAAK,IAAI,MAAM,kBAAkB,IAAI,KAAK,aAAa,OAAO,KAAK,YAAY,IAAI,KAAK,WAAW;AACnG,iBAAK,IAAI,MAAM,wBAAwB;AACvC,mBAAO,KAAK,UAAU,EAAE,KAAK,MAAM;AACjC,qBAAO,KAAK,cAAc;AAAA,YAC5B,CAAC;AAAA,UACH;AACA,eAAK,qBAAqB;AAC1B,iBAAO,KAAK,YAAY,IAAI,KAAK,YAAY,KAAK;AAAA,QACpD;AAEA,cAAM,oBAAoB,KAAK,aAAa,QAAQ,IAAI,KAAK,OAAO,QAAQ;AAC5E,YAAI;AACF,gBAAM,WAAW,KAAK,MAAM,iBAAiB;AAC7C,eAAK,IAAI,MAAM,QAAQ;AACvB,cAAI,SAAS,eAAe,GAAG;AAC7B,mBAAO,KAAK,YAAY,SAAS,YAAY,KAAK;AAAA,UACpD;AACA,iBAAO;AAAA,QACT,SAAS,OAAP;AACA,iBAAO,KAAK,YAAY,KAAK,MAAM,iBAAiB,EAAE,YAAY,KAAK;AAAA,QACzE;AAAA,MACF,CAAC,EACA,MAAM,CAAC,UAAiB;AACvB,eAAO,KAAK,YAAY,MAAM,SAAS,KAAK;AAAA,MAC9C,CAAC;AAAA,IACL;AACA,WAAO,IAAI,QAAc,CAAC,SAAS,WAAW;AAC5C,aAAO;AAAA,IACT,CAAC;AAAA,EACH;AAAA,EAEU,kBAAkB,SAA+B;AACzD,QAAI,KAAK,iBAAiB;AACxB,YAAM,OAAO,KAAK,gBAAgB,QAAQ,OAAO;AAEjD,aAAO,KAAK,YAAY,WAAW,KAAK,kBAAkB,eAAe,EAAE,KAAK,KAAK,IAAI,SAAS,EAAE,CAAC,EAClG,KAAK,CAAC,QAAQ;AACb,eAAO,KAAK,MAAM,KAAK,gBAAgB,QAAQ,GAAG,CAAC;AAAA,MACrD,CAAC,EACA,MAAM,CAAC,UAAiB;AACvB,eAAO,KAAK,YAAY,MAAM,SAAS,KAAK;AAAA,MAC9C,CAAC;AAAA,IACL;AACA,WAAO,IAAI,QAAc,CAAC,SAAS,WAAW;AAC5C,aAAO;AAAA,IACT,CAAC;AAAA,EACH;AAAA,EAEA,MAAgB,YAA2B;AACzC,SAAK;AACL,WAAO,KAAK,UAAU,EAAE,KAAK,MAAM;AACjC,WAAK,MAAM,EAAE,KAAK,MAAM;AACtB;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAAA,EACH;AAAA,EAEA,MAAgB,eAA8B;AAC5C,SAAK;AACL,WAAO,KAAK,cAAc,EAAE,KAAK,MAAM;AACrC;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEQ,iBAAuB;AAC7B,QAAI,KAAK,SAAS;AAChB,WAAK,cAAc,EAChB,KAAK,MAAM;AACV,aAAK,IAAI,KAAK,iCAAiC;AAAA,MACjD,CAAC,EACA,MAAM,MAAM;AACX,aAAK,IAAI,MAAM,2BAA2B;AAC1C,aAAK,UAAU;AAAA,MACjB,CAAC;AAAA,IACL,OAAO;AACL,WAAK,UAAU,EAAE,KAAK,MAAM;AAC1B,aAAK,MAAM,EACR,KAAK,MAAM;AACV,eAAK,IAAI,KAAK,4BAA4B;AAAA,QAC5C,CAAC,EACA,MAAM,MAAM;AACX,eAAK,IAAI,MAAM,cAAc;AAAA,QAC/B,CAAC;AAAA,MACL,CAAC;AAAA,IACH;AAAA,EACF;AACF;",
  "names": ["import_axios", "crypto", "axios", "utf8", "uuidv4", "TpLinkCipher", "res", "NewTpLinkCipher", "URL", "headers"]
}
